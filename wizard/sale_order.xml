<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record model="ir.ui.view" id="view_wizard_form">
        <field name="name">Sale.Wizard.form</field>
        <field name="model">sale.exl</field>
        <field name="arch" type="xml">
            <form>
           <group>
                 <field name="xl_data" filename="filename"/>
                 <field name="filename" invisible="1"/>
                 <field name="active_id" invisible="1"/>
                 <field name="check_val" invisible="1"/>
                 <field name="check_error" invisible="1"/>
                 <field name="error_msg" attrs="{'invisible': [('check_error', '=', False)]}" id="err" readonly="1"/>
        </group>
        <group>
              <div>
                <h2> General Instructions</h2>
                  <li>Only <b>.xls</b> and <b>.xlsx</b> file format is supported </li>
                  <li>Column heading must be like <b> Code,Name,Qty,Price,Discount </b></li>
                  <li><b>Code</b> Column is manadatory while import</li>
                  <li><b>Code</b> Column value must be match to your product internal reference.</li>
                  <li>if <b>Qty</b> Column is not given then system will take qty from server parameter</li>
                  <li>After Exporting file You will see<b> ID</b> Dont remove or modify it if you want to update Existing Order line</li>
                  <li>You can update Existing order line after exporting current order in excel file by clicking on Export button and then reimport it by modify name ,qty ,price or discount </li>
                  <li>Your <b>ID</b> column exist in Excel file and there is no any value in other cells then system will not do anything.</li>
                  <li>You can add New Product and modify existing lines at same time. Just keep ID cell blank for the products which you want to add as new item</li>
                  <li>if you remove order line from odoo and still ID exist in excel file then system will ignore that row</li>
                  <li>While you importing a new row, if <b>Code</b> column value is not specified then system will ignore that row</li>
                  <li>if <b>Price</b> is not specified in cell by keeping it blank then system will take price from Pricelist</li>
                  <li>if wrong <b>Product Code</b> will be specified in any cell then whole row will be ignored</li>
                
              </div>
            </group>
        <footer>
             <button name="order_import" string="Import" type="object" default_focus="1" class="oe_highlight" attrs="{'invisible': [('check_val', '=', False)]}"/> 
             <button name="validate_file" string="Validate" type="object" default_focus="1" class="oe_highlight" attrs="{'invisible': [('check_val', '=', True)]}"/>
             <button name="order_export" string="Export Template" type="object" default_focus="1" class="oe_highlight"/>
              <button string="Cancel" class="oe_link" special="cancel"/>
        </footer>
        </form>
        
        </field>
    </record>

      <record model="ir.actions.act_window" id="sale_order_import_action">
        <field name="name">Import/Export Sale Order Lines</field>
        <field name="res_model">sale.exl</field>
        <field name="src_model">sale.order</field>
        <field name="domain">[('states','=','draft')]</field>
        <field name="target">new</field>
      </record>



    <record model="ir.ui.view" id="view_sale_form">
            <field name="name">sale.order.form</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="/form/header/button[@name='action_confirm']" position="after">
                        <button type="action" string="Import Orderlines" help="Import/Export Sale Orderlines" name= "%(sale_order_import_action)d" groups="import-export_sale_order.group_sale_impex_orderline" states="draft"/>
                </xpath>
            </field>
        </record>


    </data>
</odoo>
